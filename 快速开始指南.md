# 800g OSFP光模块生产数据分析工具 - 快速开始指南

## 🚀 快速启动

### Windows用户
双击运行 `run.bat` 文件，系统会自动：
- 检查Python是否安装
- 安装所需依赖包
- 启动Web服务

### Linux/Mac用户
```bash
chmod +x run.sh
./run.sh
```

### 手动启动
```bash
pip install -r requirements.txt
python app.py
```

启动后访问：http://localhost:5000

## 📋 使用步骤

### 1. 配置AI设置
- 输入OpenAI API Key
- 选择模型（推荐gpt-4）
- 自定义分析提示词（可选）
- 点击"保存配置"

### 2. 上传数据文件
按以下顺序上传Excel文件：

**必需文件：**
- ✅ **SN映射关系**：包含`pcba_sn`和`shell_sn`的映射
- ✅ **测试结果**：包含`shell_sn`和测试结果（PASS/FAIL）

**可选文件：**
- 📎 **贴片数据**：包含`sn`（PCBA SN）和贴片工艺参数
- 📎 **引线键合数据**：包含`sn`和键合工艺参数  
- 📎 **Lens耦合数据**：包含`sn`和耦合工艺参数

### 3. 数据分析
1. 点击"上传并分析数据"进行初步分析
2. 等待系统完成：
   - 相关性分析
   - T检验分析
   - 随机森林分析
3. 点击"AI深度分析"获取专业见解

### 4. 查看结果
- 📊 相关性热力图
- 📈 特征重要性图表
- 📝 AI生成的RCA分析报告
- 💾 下载分析图片

## 📁 数据格式要求

### SN映射文件（必需）
| pcba_sn | shell_sn | assembly_date |
|---------|----------|---------------|
| PCBA00001 | SHELL01001 | 2024-01-01 |

### 测试结果文件（必需）
| shell_sn | test_result | optical_power_output_dbm |
|----------|-------------|-------------------------|
| SHELL01001 | PASS | -2.1 |
| SHELL01002 | FAIL | -8.5 |

### 生产数据文件（可选）
任何包含`sn`列（PCBA SN）和工艺参数的Excel文件。

## 🎯 分析功能说明

### 相关性分析
- 识别工艺参数间的关联关系
- 生成相关性热力图
- 发现强相关参数对（|r| ≥ 0.5）

### T检验分析
- 比较PASS和FAIL样本的参数差异
- 计算p值和效应量（Cohen's d）
- 识别对质量有显著影响的参数

### 随机森林分析
- 训练机器学习模型预测产品质量
- 计算特征重要性排序
- 识别影响质量的关键工艺参数

### AI根本原因分析
- 基于统计分析结果进行深度解读
- 结合800g OSFP光模块工作原理
- 提供专业的改进建议和预防措施

## 🔧 常见问题

**Q: 上传文件失败怎么办？**
- 确保文件格式为.xlsx或.xls
- 检查文件大小不超过100MB
- 确认文件包含必要的SN列

**Q: AI分析没有响应？**
- 检查OpenAI API Key是否正确
- 确认网络可以访问OpenAI服务
- 查看浏览器控制台是否有错误信息

**Q: 数据关联失败？**
- 确认SN映射文件包含`pcba_sn`和`shell_sn`列
- 检查SN格式是否一致
- 验证是否有重复的SN码

**Q: 分析结果不准确？**
- 增加数据样本量（建议≥50个样本）
- 确保PASS和FAIL样本都有足够数量
- 检查数据质量和完整性

## 📈 示例数据

运行`python sample_data_format.py`可生成示例数据文件，包含：
- 100个样本的完整生产数据
- 符合800g OSFP光模块特点的参数
- 可直接用于测试系统功能

## 🛠️ 高级设置

### 配置文件 (config.json)
```json
{
  "analysis": {
    "correlation_threshold": 0.5,
    "t_test_alpha": 0.05,
    "random_forest_n_estimators": 100
  }
}
```

### 自定义列名映射
如果您的数据列名不标准，可以在配置文件中添加映射关系。

## 💡 最佳实践

1. **数据准备**：确保数据完整性和一致性
2. **样本量**：建议每个工序至少50个样本
3. **数据质量**：定期清理异常值和重复数据
4. **定期分析**：建议每周或每批次进行分析
5. **结果跟踪**：记录改进措施的效果验证

## 📞 技术支持

如遇技术问题，请检查：
1. `app.py`中的日志输出
2. 浏览器开发者工具中的错误信息
3. 确认所有依赖包正确安装
